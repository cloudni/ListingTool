<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lt.dao.mapper.EbayCategoryMapper" >
  <resultMap id="BaseResultMap" type="com.lt.dao.model.EbayCategory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="AutoPayEnabled" property="autopayenabled" jdbcType="BIT" />
    <result column="B2BVATEnabled" property="b2bvatenabled" jdbcType="BIT" />
    <result column="BestOfferEnabled" property="bestofferenabled" jdbcType="BIT" />
    <result column="CategoryID" property="categoryid" jdbcType="VARCHAR" />
    <result column="CategorySiteID" property="categorysiteid" jdbcType="INTEGER" />
    <result column="CategoryLevel" property="categorylevel" jdbcType="INTEGER" />
    <result column="CategoryName" property="categoryname" jdbcType="VARCHAR" />
    <result column="CategoryParentID" property="categoryparentid" jdbcType="VARCHAR" />
    <result column="Expired" property="expired" jdbcType="BIT" />
    <result column="LeafCategory" property="leafcategory" jdbcType="BIT" />
    <result column="LSD" property="lsd" jdbcType="BIT" />
    <result column="ORPA" property="orpa" jdbcType="BIT" />
    <result column="ORRA" property="orra" jdbcType="BIT" />
    <result column="Virtual" property="virtual" jdbcType="BIT" />
    <result column="ebay_entity_type_id" property="ebayEntityTypeId" jdbcType="INTEGER" />
    <result column="ebay_attribute_set_id" property="ebayAttributeSetId" jdbcType="INTEGER" />
    <result column="note" property="note" jdbcType="VARCHAR" />
    <result column="google_adwords_category_id" property="googleAdwordsCategoryId" jdbcType="INTEGER" />
    <result column="create_time_utc" property="createTimeUtc" jdbcType="INTEGER" />
    <result column="create_user_id" property="createUserId" jdbcType="INTEGER" />
    <result column="update_time_utc" property="updateTimeUtc" jdbcType="INTEGER" />
    <result column="update_user_id" property="updateUserId" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    id, AutoPayEnabled, B2BVATEnabled, BestOfferEnabled, CategoryID, CategorySiteID, 
    CategoryLevel, CategoryName, CategoryParentID, Expired, LeafCategory, LSD, ORPA, 
    ORRA, Virtual, ebay_entity_type_id, ebay_attribute_set_id, note, google_adwords_category_id, 
    create_time_utc, create_user_id, update_time_utc, update_user_id
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from lt_ebay_category
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    delete from lt_ebay_category
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.lt.dao.model.EbayCategory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    insert into lt_ebay_category (id, AutoPayEnabled, B2BVATEnabled, 
      BestOfferEnabled, CategoryID, CategorySiteID, 
      CategoryLevel, CategoryName, CategoryParentID, 
      Expired, LeafCategory, LSD, ORPA, 
      ORRA, Virtual, ebay_entity_type_id, 
      ebay_attribute_set_id, note, google_adwords_category_id, 
      create_time_utc, create_user_id, update_time_utc, 
      update_user_id)
    values (#{id,jdbcType=INTEGER}, #{autopayenabled,jdbcType=BIT}, #{b2bvatenabled,jdbcType=BIT}, 
      #{bestofferenabled,jdbcType=BIT}, #{categoryid,jdbcType=VARCHAR}, #{categorysiteid,jdbcType=INTEGER}, 
      #{categorylevel,jdbcType=INTEGER}, #{categoryname,jdbcType=VARCHAR}, #{categoryparentid,jdbcType=VARCHAR}, 
      #{expired,jdbcType=BIT}, #{leafcategory,jdbcType=BIT}, #{lsd,jdbcType=BIT}, #{orpa,jdbcType=BIT}, 
      #{orra,jdbcType=BIT}, #{virtual,jdbcType=BIT}, #{ebayEntityTypeId,jdbcType=INTEGER}, 
      #{ebayAttributeSetId,jdbcType=INTEGER}, #{note,jdbcType=VARCHAR}, #{googleAdwordsCategoryId,jdbcType=INTEGER}, 
      #{createTimeUtc,jdbcType=INTEGER}, #{createUserId,jdbcType=INTEGER}, #{updateTimeUtc,jdbcType=INTEGER}, 
      #{updateUserId,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.lt.dao.model.EbayCategory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    insert into lt_ebay_category
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="autopayenabled != null" >
        AutoPayEnabled,
      </if>
      <if test="b2bvatenabled != null" >
        B2BVATEnabled,
      </if>
      <if test="bestofferenabled != null" >
        BestOfferEnabled,
      </if>
      <if test="categoryid != null" >
        CategoryID,
      </if>
      <if test="categorysiteid != null" >
        CategorySiteID,
      </if>
      <if test="categorylevel != null" >
        CategoryLevel,
      </if>
      <if test="categoryname != null" >
        CategoryName,
      </if>
      <if test="categoryparentid != null" >
        CategoryParentID,
      </if>
      <if test="expired != null" >
        Expired,
      </if>
      <if test="leafcategory != null" >
        LeafCategory,
      </if>
      <if test="lsd != null" >
        LSD,
      </if>
      <if test="orpa != null" >
        ORPA,
      </if>
      <if test="orra != null" >
        ORRA,
      </if>
      <if test="virtual != null" >
        Virtual,
      </if>
      <if test="ebayEntityTypeId != null" >
        ebay_entity_type_id,
      </if>
      <if test="ebayAttributeSetId != null" >
        ebay_attribute_set_id,
      </if>
      <if test="note != null" >
        note,
      </if>
      <if test="googleAdwordsCategoryId != null" >
        google_adwords_category_id,
      </if>
      <if test="createTimeUtc != null" >
        create_time_utc,
      </if>
      <if test="createUserId != null" >
        create_user_id,
      </if>
      <if test="updateTimeUtc != null" >
        update_time_utc,
      </if>
      <if test="updateUserId != null" >
        update_user_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="autopayenabled != null" >
        #{autopayenabled,jdbcType=BIT},
      </if>
      <if test="b2bvatenabled != null" >
        #{b2bvatenabled,jdbcType=BIT},
      </if>
      <if test="bestofferenabled != null" >
        #{bestofferenabled,jdbcType=BIT},
      </if>
      <if test="categoryid != null" >
        #{categoryid,jdbcType=VARCHAR},
      </if>
      <if test="categorysiteid != null" >
        #{categorysiteid,jdbcType=INTEGER},
      </if>
      <if test="categorylevel != null" >
        #{categorylevel,jdbcType=INTEGER},
      </if>
      <if test="categoryname != null" >
        #{categoryname,jdbcType=VARCHAR},
      </if>
      <if test="categoryparentid != null" >
        #{categoryparentid,jdbcType=VARCHAR},
      </if>
      <if test="expired != null" >
        #{expired,jdbcType=BIT},
      </if>
      <if test="leafcategory != null" >
        #{leafcategory,jdbcType=BIT},
      </if>
      <if test="lsd != null" >
        #{lsd,jdbcType=BIT},
      </if>
      <if test="orpa != null" >
        #{orpa,jdbcType=BIT},
      </if>
      <if test="orra != null" >
        #{orra,jdbcType=BIT},
      </if>
      <if test="virtual != null" >
        #{virtual,jdbcType=BIT},
      </if>
      <if test="ebayEntityTypeId != null" >
        #{ebayEntityTypeId,jdbcType=INTEGER},
      </if>
      <if test="ebayAttributeSetId != null" >
        #{ebayAttributeSetId,jdbcType=INTEGER},
      </if>
      <if test="note != null" >
        #{note,jdbcType=VARCHAR},
      </if>
      <if test="googleAdwordsCategoryId != null" >
        #{googleAdwordsCategoryId,jdbcType=INTEGER},
      </if>
      <if test="createTimeUtc != null" >
        #{createTimeUtc,jdbcType=INTEGER},
      </if>
      <if test="createUserId != null" >
        #{createUserId,jdbcType=INTEGER},
      </if>
      <if test="updateTimeUtc != null" >
        #{updateTimeUtc,jdbcType=INTEGER},
      </if>
      <if test="updateUserId != null" >
        #{updateUserId,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.lt.dao.model.EbayCategory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    update lt_ebay_category
    <set >
      <if test="autopayenabled != null" >
        AutoPayEnabled = #{autopayenabled,jdbcType=BIT},
      </if>
      <if test="b2bvatenabled != null" >
        B2BVATEnabled = #{b2bvatenabled,jdbcType=BIT},
      </if>
      <if test="bestofferenabled != null" >
        BestOfferEnabled = #{bestofferenabled,jdbcType=BIT},
      </if>
      <if test="categoryid != null" >
        CategoryID = #{categoryid,jdbcType=VARCHAR},
      </if>
      <if test="categorysiteid != null" >
        CategorySiteID = #{categorysiteid,jdbcType=INTEGER},
      </if>
      <if test="categorylevel != null" >
        CategoryLevel = #{categorylevel,jdbcType=INTEGER},
      </if>
      <if test="categoryname != null" >
        CategoryName = #{categoryname,jdbcType=VARCHAR},
      </if>
      <if test="categoryparentid != null" >
        CategoryParentID = #{categoryparentid,jdbcType=VARCHAR},
      </if>
      <if test="expired != null" >
        Expired = #{expired,jdbcType=BIT},
      </if>
      <if test="leafcategory != null" >
        LeafCategory = #{leafcategory,jdbcType=BIT},
      </if>
      <if test="lsd != null" >
        LSD = #{lsd,jdbcType=BIT},
      </if>
      <if test="orpa != null" >
        ORPA = #{orpa,jdbcType=BIT},
      </if>
      <if test="orra != null" >
        ORRA = #{orra,jdbcType=BIT},
      </if>
      <if test="virtual != null" >
        Virtual = #{virtual,jdbcType=BIT},
      </if>
      <if test="ebayEntityTypeId != null" >
        ebay_entity_type_id = #{ebayEntityTypeId,jdbcType=INTEGER},
      </if>
      <if test="ebayAttributeSetId != null" >
        ebay_attribute_set_id = #{ebayAttributeSetId,jdbcType=INTEGER},
      </if>
      <if test="note != null" >
        note = #{note,jdbcType=VARCHAR},
      </if>
      <if test="googleAdwordsCategoryId != null" >
        google_adwords_category_id = #{googleAdwordsCategoryId,jdbcType=INTEGER},
      </if>
      <if test="createTimeUtc != null" >
        create_time_utc = #{createTimeUtc,jdbcType=INTEGER},
      </if>
      <if test="createUserId != null" >
        create_user_id = #{createUserId,jdbcType=INTEGER},
      </if>
      <if test="updateTimeUtc != null" >
        update_time_utc = #{updateTimeUtc,jdbcType=INTEGER},
      </if>
      <if test="updateUserId != null" >
        update_user_id = #{updateUserId,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.lt.dao.model.EbayCategory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 09 17:48:04 CST 2015.
    -->
    update lt_ebay_category
    set AutoPayEnabled = #{autopayenabled,jdbcType=BIT},
      B2BVATEnabled = #{b2bvatenabled,jdbcType=BIT},
      BestOfferEnabled = #{bestofferenabled,jdbcType=BIT},
      CategoryID = #{categoryid,jdbcType=VARCHAR},
      CategorySiteID = #{categorysiteid,jdbcType=INTEGER},
      CategoryLevel = #{categorylevel,jdbcType=INTEGER},
      CategoryName = #{categoryname,jdbcType=VARCHAR},
      CategoryParentID = #{categoryparentid,jdbcType=VARCHAR},
      Expired = #{expired,jdbcType=BIT},
      LeafCategory = #{leafcategory,jdbcType=BIT},
      LSD = #{lsd,jdbcType=BIT},
      ORPA = #{orpa,jdbcType=BIT},
      ORRA = #{orra,jdbcType=BIT},
      Virtual = #{virtual,jdbcType=BIT},
      ebay_entity_type_id = #{ebayEntityTypeId,jdbcType=INTEGER},
      ebay_attribute_set_id = #{ebayAttributeSetId,jdbcType=INTEGER},
      note = #{note,jdbcType=VARCHAR},
      google_adwords_category_id = #{googleAdwordsCategoryId,jdbcType=INTEGER},
      create_time_utc = #{createTimeUtc,jdbcType=INTEGER},
      create_user_id = #{createUserId,jdbcType=INTEGER},
      update_time_utc = #{updateTimeUtc,jdbcType=INTEGER},
      update_user_id = #{updateUserId,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>
  
  <!-- 自定义 -->
  <resultMap id="PoResultMap" type="com.lt.dao.po.EbayCategoryPO" extends="BaseResultMap">
  	<result column="assignFlag" property="assignFlag" jdbcType="BIT" />
  	<result column="parentFlag" property="parentFlag" jdbcType="BIT" />
  	<result column="CategoryNameCn" property="categoryNameCn" jdbcType="VARCHAR"/>
  </resultMap>
  
  <select id="selectByParentId" resultMap="PoResultMap" parameterType="com.lt.dao.po.EbayCategoryPO" >
     select  *
	from (select t1.id, t1.CategoryID, t1.CategoryLevel, t1.CategoryName, t1.CategoryNameCn, 
	   		t1.CategoryParentID, t1.google_adwords_category_id,
				(case when t2.id is null then 0 else 1 end) as parentFlag,
				(case when t1.google_adwords_category_id is null then 0 else 1 end) as assignFlag
	    from lt_ebay_category t1 left JOIN lt_ebay_category t2
			on t1.CategoryID = t2.CategoryParentID and t1.CategorySiteID = t2.CategorySiteID
	    where t1.CategorySiteID = #{categorysiteid}
		 <if test="categoryparentid != null and categoryparentid != ''">
	    	and t1.CategoryParentID = #{categoryparentid}
	    	and t1.CategoryID != #{categoryparentid}
	    </if>
	    <if test="categoryparentid == null or categoryparentid ==''">
	    	and t1.CategoryLevel = 1
	    </if>	
	) t3
	group by t3.id
  </select>
  <update id="updateByCategoryIdSelective" parameterType="com.lt.dao.model.EbayCategory" >
    update lt_ebay_category
    <set >
      <if test="autopayenabled != null" >
        AutoPayEnabled = #{autopayenabled,jdbcType=BIT},
      </if>
      <if test="b2bvatenabled != null" >
        B2BVATEnabled = #{b2bvatenabled,jdbcType=BIT},
      </if>
      <if test="bestofferenabled != null" >
        BestOfferEnabled = #{bestofferenabled,jdbcType=BIT},
      </if>
      <if test="categorylevel != null" >
        CategoryLevel = #{categorylevel,jdbcType=INTEGER},
      </if>
      <if test="categoryname != null" >
        CategoryName = #{categoryname,jdbcType=VARCHAR},
      </if>
      <if test="categoryparentid != null" >
        CategoryParentID = #{categoryparentid,jdbcType=VARCHAR},
      </if>
      <if test="expired != null" >
        Expired = #{expired,jdbcType=BIT},
      </if>
      <if test="leafcategory != null" >
        LeafCategory = #{leafcategory,jdbcType=BIT},
      </if>
      <if test="lsd != null" >
        LSD = #{lsd,jdbcType=BIT},
      </if>
      <if test="orpa != null" >
        ORPA = #{orpa,jdbcType=BIT},
      </if>
      <if test="orra != null" >
        ORRA = #{orra,jdbcType=BIT},
      </if>
      <if test="virtual != null" >
        Virtual = #{virtual,jdbcType=BIT},
      </if>
      <if test="ebayEntityTypeId != null" >
        ebay_entity_type_id = #{ebayEntityTypeId,jdbcType=INTEGER},
      </if>
      <if test="ebayAttributeSetId != null" >
        ebay_attribute_set_id = #{ebayAttributeSetId,jdbcType=INTEGER},
      </if>
      <if test="note != null" >
        note = #{note,jdbcType=VARCHAR},
      </if>
      <if test="googleAdwordsCategoryId != null" >
        google_adwords_category_id = #{googleAdwordsCategoryId,jdbcType=INTEGER},
      </if>
      <if test="createTimeUtc != null" >
        create_time_utc = #{createTimeUtc,jdbcType=INTEGER},
      </if>
      <if test="createUserId != null" >
        create_user_id = #{createUserId,jdbcType=INTEGER},
      </if>
      <if test="updateTimeUtc != null" >
        update_time_utc = #{updateTimeUtc,jdbcType=INTEGER},
      </if>
      <if test="updateUserId != null" >
        update_user_id = #{updateUserId,jdbcType=INTEGER},
      </if>
    </set>
    where CategoryID = #{categoryid,jdbcType=INTEGER}
    and CategorySiteID = #{categorysiteid,jdbcType=INTEGER}
  </update>
</mapper>